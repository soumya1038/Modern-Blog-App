{% extends "base.html" %}

{% block title %}Register - Modern Blog{% endblock %}

{% block content %}
<div class="max-w-md mx-auto animate-fade-in">
    <div class="text-center mb-8">
        <div class="inline-block p-6 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-3xl mb-6">
            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-2xl text-white shadow-xl mx-auto">
                ✨
            </div>
        </div>
        <h1 class="text-3xl font-bold bg-gradient-to-r from-gray-900 via-indigo-900 to-purple-900 bg-clip-text text-transparent mb-4">
            Join ModernBlog
        </h1>
        <p class="text-gray-600">
            Create your account to start blogging
        </p>
    </div>

    <form id="registerForm" class="space-y-6">
        <div class="animate-slide-up">
            <label for="username" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">👤</span> Username
            </label>
            <input type="text" 
                   id="username" 
                   name="username" 
                   required
                   class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all duration-200 text-lg font-medium bg-white/70 backdrop-blur-sm hover:border-indigo-300"
                   placeholder="Choose a username">
        </div>

        <div class="animate-slide-up" style="animation-delay: 0.05s">
            <label for="password" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">🔒</span> Password
            </label>
            <input type="password" 
                   id="password" 
                   name="password" 
                   required
                   minlength="6"
                   class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all duration-200 text-lg font-medium bg-white/70 backdrop-blur-sm hover:border-indigo-300"
                   placeholder="Create a password (min 6 characters)">
        </div>
        
        <div class="flex items-center animate-slide-up" style="animation-delay: 0.07s">
            <input type="checkbox" name="remember_me" id="remember_me" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
            <label for="remember_me" class="ml-2 block text-sm text-gray-700">Remember me</label>
        </div>

        <div class="flex gap-4 animate-slide-up" style="animation-delay: 0.1s">
            <button type="submit" 
                    class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-4 rounded-2xl hover:shadow-2xl hover:scale-105 transition-all duration-300 font-semibold text-lg flex items-center justify-center">
                <span class="mr-2">🚀</span>
                Create Account
            </button>
        </div>
    </form>

    <div class="text-center mt-6 space-y-2 animate-slide-up" style="animation-delay: 0.2s">
        <p class="text-gray-600">Already have an account?</p>
        <a href="{{ url_for('login') }}" class="text-indigo-600 hover:text-indigo-700 font-medium">
            Sign in here
        </a>
    </div>

    <div class="text-center mt-4 animate-slide-up" style="animation-delay: 0.3s">
        <a href="{{ url_for('index') }}" class="text-gray-500 hover:text-gray-700 text-sm">
            ← Back to Home
        </a>
    </div>
</div>

<script>
document.getElementById('registerForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const username = formData.get('username');
    const password = formData.get('password');
    const rememberMe = formData.get('remember_me') === 'on';
    
    const submitData = new FormData();
    submitData.append('username', username);
    submitData.append('password', password);
    if (rememberMe) {
        submitData.append('remember_me', 'on');
    }
    
    fetch('/register', {
        method: 'POST',
        headers: {
            'Accept': 'application/json'
        },
        body: submitData
    })
    .then(response => {
        if (response.ok) {
            return response.json();
        }
        throw new Error('Network response was not ok');
    })
    .then(result => {
        if (result.success) {
            if (result.remember) {
                localStorage.setItem('blogAppCredentials', JSON.stringify({
                    username: username,
                    password: password
                }));
            }
            window.location.href = '/';
        } else {
            alert(result.message || 'Registration failed');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Registration failed: ' + error.message);
    });
});
</script>
{% endblock %}