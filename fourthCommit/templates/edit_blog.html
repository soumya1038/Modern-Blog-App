{% extends "base.html" %}

{% block title %}Edit Post - Modern Blog{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto animate-fade-in">
    <div class="text-center mb-12">
        <div class="inline-block p-6 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-3xl mb-6">
            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-2xl text-white shadow-xl mx-auto">
                ‚úèÔ∏è
            </div>
        </div>
        <h1 class="text-4xl font-bold bg-gradient-to-r from-gray-900 via-indigo-900 to-purple-900 bg-clip-text text-transparent mb-4">
            Edit Post
        </h1>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">
            Update your blog post using 
            <span class="bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent font-semibold">Markdown</span> 
            for rich formatting
        </p>
    </div>

    <form method="POST" class="space-y-6">
        <div class="animate-slide-up">
            <label for="title" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">üìù</span> Title
            </label>
            <input type="text" 
                   id="title" 
                   name="title" 
                   required
                   value="{{ blog.title }}"
                   class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all duration-200 text-lg font-medium bg-white/70 backdrop-blur-sm hover:border-indigo-300">
        </div>

        <div class="animate-slide-up" style="animation-delay: 0.03s">
            <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">üë§</span> Author
            </label>
            <div class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl bg-gray-50 text-lg font-medium text-gray-700">
                {{ blog.author }}
            </div>
        </div>

        <div class="animate-slide-up" style="animation-delay: 0.05s">
            <label for="tags" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">üè∑Ô∏è</span> Tags
            </label>
            <input type="text" 
                   id="tags" 
                   name="tags" 
                   value="{{ blog.tags|join(', ') if blog.tags else '' }}"
                   class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all duration-200 text-lg font-medium bg-white/70 backdrop-blur-sm hover:border-indigo-300"
                   placeholder="Enter tags separated by commas (e.g., technology, programming, web)">
        </div>

        <div class="animate-slide-up" style="animation-delay: 0.1s">
            <label for="content" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                <span class="mr-2">üìÑ</span> Content (Markdown)
            </label>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 font-medium">EDITOR</span>
                        <div class="flex items-center space-x-4 text-xs text-gray-500">
                            <span id="wordCount">0 words</span>
                            <span id="readingTime">0 min read</span>
                            <div class="flex space-x-1">
                                <div class="w-2 h-2 bg-red-400 rounded-full"></div>
                                <div class="w-2 h-2 bg-yellow-400 rounded-full"></div>
                                <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                            </div>
                        </div>
                    </div>
                    <textarea id="content" 
                              name="content" 
                              required
                              rows="24"
                              class="w-full px-6 py-4 border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all duration-200 font-mono text-sm bg-white/70 backdrop-blur-sm hover:border-indigo-300 resize-none">{{ blog.content }}</textarea>
                </div>
                <div class="hidden lg:block space-y-2">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-500 font-medium">LIVE PREVIEW</span>
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-indigo-400 rounded-full animate-pulse"></div>
                            <div class="w-2 h-2 bg-purple-400 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                            <div class="w-2 h-2 bg-pink-400 rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                        </div>
                    </div>
                    <div id="preview" class="w-full h-96 p-6 border-2 border-gray-200 rounded-2xl bg-gradient-to-br from-white to-gray-50 overflow-auto prose prose-sm max-w-none shadow-inner"></div>
                </div>
            </div>
        </div>

        <div class="flex gap-4 animate-slide-up" style="animation-delay: 0.2s">
            <button type="submit" 
                    class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-4 rounded-2xl hover:shadow-2xl hover:scale-105 transition-all duration-300 font-semibold text-lg flex items-center">
                <span class="mr-2">üíæ</span>
                Update Post
            </button>
            <a href="{{ url_for('view_blog', blog_id=blog.id) }}" 
               class="bg-white/70 backdrop-blur-sm text-gray-700 px-8 py-4 rounded-2xl hover:bg-gray-100 transition-all duration-200 font-semibold text-lg border-2 border-gray-200 hover:border-gray-300 flex items-center">
                <span class="mr-2">‚Üê</span>
                Cancel
            </a>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    const contentTextarea = document.getElementById('content');
    const preview = document.getElementById('preview');
    
    function updatePreview() {
        const markdown = contentTextarea.value;
        if (markdown.trim()) {
            preview.innerHTML = marked.parse(markdown);
        } else {
            preview.innerHTML = '<p class="text-gray-500 italic">Start typing to see preview...</p>';
        }
    }
    
    function updateStats() {
        const content = contentTextarea.value;
        const words = content.trim() ? content.trim().split(/\s+/).length : 0;
        const readingTime = Math.max(1, Math.ceil(words / 200));
        
        document.getElementById('wordCount').textContent = `${words} words`;
        document.getElementById('readingTime').textContent = `${readingTime} min read`;
    }
    
    contentTextarea.addEventListener('input', () => {
        updatePreview();
        updateStats();
    });
    
    updatePreview();
    updateStats();
</script>
{% endblock %}